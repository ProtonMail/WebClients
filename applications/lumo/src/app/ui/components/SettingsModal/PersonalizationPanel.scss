@use '~@proton/styles/scss/lib/config' as *;
@use '~@proton/styles/scss/lib/include-media' as im;
im.$breakpoints: $breakpoints-product;
im.$media-expressions: $media-expressions;


.personalization-panel {
    display: flex;
    flex-direction: column;
    height: 100%; /* Fill the parent container */
    min-height: 0; /* Allow flex item to shrink */
    max-height: 100%; /* Prevent overflow */

    .personalization-content {
        flex: 1;
        overflow-y: auto;
        padding: 1rem;
        min-height: 0; /* Allow flex item to shrink */
        
        // On mobile, ensure content doesn't take up all space so footer is visible
        @include im.media('<=small') {
            max-height: calc(100vh - 16rem); // Reserve space for header, tabs, and footer
        }
    }

    .personalization-field {

        label {
            display: flex;
            align-items: center;
            font-weight: 600;
            margin-bottom: 0.25rem;
            color: var(--text-norm);
            font-size: 0.8125rem;
        }

        // Style the actual input and textarea elements
        input, textarea {
            border: 1px solid var(--border-weak);
            padding: 10px;
            border-radius: 8px;
        }

        // File upload section styling
        .file-upload-section {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: 0.5rem;

            .file-upload-button {
                align-self: flex-start;
                cursor: pointer;
                
                &:disabled {
                    opacity: 0.6;
                    cursor: not-allowed;
                }
            }

            .file-upload-hint {
                font-size: 0.75rem;
                line-height: 1.2;
            }
        }
    }

    .personalization-footer {
        flex-shrink: 0; // Prevent footer from shrinking
        padding: 1rem;
        border-top: 1px solid var(--border-weak);
        background-color: var(--background-norm);
        margin-top: auto; // Push to bottom if content is short
        margin-bottom: 1rem;
        
        // Ensure footer is always visible on mobile
        @include im.media('<=small') {
            position: sticky;
            bottom: 0;
            z-index: 10;
            margin-bottom: 0;
            padding-bottom: 1.5rem; // Extra padding for mobile safe area
        }
    }

    .trait-pills {
        .trait-pill {
            transition: all 0.2s ease;
            border: 1px solid var(--border-weak);
            font-size: 0.8125rem; // Make trait buttons more compact
            padding: 0.375rem 0.75rem;

            &:hover {
                border-color: var(--interaction-norm);
                background-color: var(--interaction-weak);
            }

            &--selected {
                background-color: var(--interaction-norm);
                border-color: var(--interaction-norm);
                color: var(--interaction-norm-contrast);

                &:hover {
                    background-color: var(--interaction-norm-hover);
                    border-color: var(--interaction-norm-hover);
                }
            }
        }

        .trait-reset {
            opacity: 0.7;

            &:hover:not(:disabled) {
                opacity: 1;
            }

            &:disabled {
                opacity: 0.3;
            }
        }
    }

    .border-top {
        border-top: 1px solid var(--border-weak);
    }
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .personalization-panel {
        .trait-pills {
            .trait-pill {
                font-size: 0.875rem;
                padding: 0.5rem 0.75rem;
            }
        }

        .personalization-field {
            label {
                font-size: 0.875rem;
            }
        }

        // On mobile, reduce footer padding and ensure it sticks to bottom
        .personalization-footer {
            padding: 1rem 1rem 1rem 1rem; // Reduce bottom padding on mobile
            margin-top: auto; // Push footer to bottom
        }

        // Reduce content padding on mobile for more space
        .personalization-content {
            padding: 0.75rem;
        }
    }
}
