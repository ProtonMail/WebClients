// Interface for SignedKeyList generated by the FE before uploading
export interface SignedKeyList {
    Data: string;
    Signature: string;
}

// Metadata of a public key included in the SKL's Data property
export interface SignedKeyListItem {
    Primary: 0 | 1;
    Flags: number;
    Fingerprint: string;
    SHA256Fingerprints: string[];
}

interface SKLEpochs {
    MinEpochID: number | null;
    MaxEpochID: number | null;
    ExpectedMinEpochID?: number;
}

export interface ActiveSignedKeyList extends SignedKeyList, SKLEpochs {}

export interface ObsolescentSignedKeyList extends SKLEpochs {
    Data: string | null;
    Signature: string | null;
}

// SKL served by the server. Note that Data and Signature
// might be missing or be null for obsolescent SKLs
export type FetchedSignedKeyList = ActiveSignedKeyList | ObsolescentSignedKeyList;
